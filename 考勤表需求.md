# ğŸ“± å·¥åœ°è€ƒå‹¤ä¸å·¥èµ„è®¡ç®— App å¼€å‘æ–‡æ¡£ï¼ˆAndroid æœ¬åœ°ç‰ˆï¼‰

## ä¸€ã€é¡¹ç›®ç›®æ ‡

å¼€å‘ä¸€ä¸ª **æœ¬åœ°ç¦»çº¿å®‰å“ App**ï¼Œç”¨äºï¼š

1. è®°å½•å·¥äººæ¯æ—¥è€ƒå‹¤
2. è‡ªåŠ¨ç»Ÿè®¡å‡ºå‹¤æƒ…å†µ
3. è‡ªåŠ¨è®¡ç®—å·¥èµ„
4. å¯¼å‡º Excel æŠ¥è¡¨

æ•°æ®å…¨éƒ¨å­˜å‚¨åœ¨æœ¬åœ° SQLite æ•°æ®åº“ã€‚

------

# äºŒã€æŠ€æœ¯è¦æ±‚

- è¯­è¨€ï¼šKotlin
- UIï¼šJetpack Compose
- æ•°æ®åº“ï¼šRoom (SQLite)
- æœ€ä½ Android ç‰ˆæœ¬ï¼šAndroid 8+
- Excel å¯¼å‡ºï¼šApache POI

------

# ä¸‰ã€æ•°æ®åº“è®¾è®¡ï¼ˆæœ€ç»ˆç‰ˆï¼‰

## 1ï¸âƒ£ å·¥äººè¡¨

```
Table: workers
```

| å­—æ®µ               | ç±»å‹      | è¯´æ˜     |
| ------------------ | --------- | -------- |
| id                 | Long (PK) | ä¸»é”®     |
| name               | String    | å·¥äººå§“å |
| dailyWage          | Double    | æ—¥å·¥èµ„   |
| overtimeHourlyWage | Double    | åŠ ç­æ—¶è–ª |
| remark             | String    | å¤‡æ³¨     |

------

## 2ï¸âƒ£ è€ƒå‹¤è¡¨

```
Table: attendance
```

| å­—æ®µ          | ç±»å‹                | è¯´æ˜         |
| ------------- | ------------------- | ------------ |
| id            | Long (PK)           | ä¸»é”®         |
| workerId      | Long (FK)           | å·¥äººID       |
| date          | String (yyyy-MM-dd) | æ—¥æœŸ         |
| morning       | Boolean             | ä¸Šåˆæ˜¯å¦ä¸Šç­ |
| afternoon     | Boolean             | ä¸‹åˆæ˜¯å¦ä¸Šç­ |
| overtimeHours | Double              | åŠ ç­å°æ—¶     |
| remark        | String              | å¤‡æ³¨         |

çº¦æŸï¼š

- workerId + date å”¯ä¸€ï¼ˆä¸€å¤©ä¸€æ¡è®°å½•ï¼‰

------

# å››ã€Room å®ä½“ç±»ç¤ºä¾‹

```
@Entity(tableName = "workers")
data class Worker(
    @PrimaryKey(autoGenerate = true)
    val id: Long = 0,
    val name: String,
    val dailyWage: Double,
    val overtimeHourlyWage: Double,
    val remark: String = ""
)
@Entity(
    tableName = "attendance",
    indices = [Index(value = ["workerId","date"], unique = true)]
)
data class Attendance(
    @PrimaryKey(autoGenerate = true)
    val id: Long = 0,
    val workerId: Long,
    val date: String,
    val morning: Boolean,
    val afternoon: Boolean,
    val overtimeHours: Double,
    val remark: String = ""
)
```

------

# äº”ã€å·¥èµ„è®¡ç®—é€»è¾‘ï¼ˆæ ¸å¿ƒï¼‰

### è§„åˆ™

- å…¨å¤© = ä¸Šåˆ + ä¸‹åˆ
- åŠå¤© = ä»…ä¸Šåˆ æˆ– ä»…ä¸‹åˆ
- åŠ ç­æŒ‰å°æ—¶ç®—

------

## Kotlin å·¥èµ„è®¡ç®—ä»£ç 

```
data class SalaryResult(
    val fullDays: Int,
    val halfDays: Int,
    val overtimeHours: Double,
    val totalSalary: Double
)

fun calculateSalary(
    worker: Worker,
    records: List<Attendance>
): SalaryResult {

    var fullDays = 0
    var halfDays = 0
    var overtime = 0.0

    for (r in records) {
        if (r.morning && r.afternoon) fullDays++
        else if (r.morning || r.afternoon) halfDays++

        overtime += r.overtimeHours
    }

    val salary =
        fullDays * worker.dailyWage +
        halfDays * (worker.dailyWage / 2) +
        overtime * worker.overtimeHourlyWage

    return SalaryResult(fullDays, halfDays, overtime, salary)
}
```

------

# å…­ã€Excel å¯¼å‡ºä»£ç æ¨¡æ¿

ä¾èµ–ï¼š

```
implementation "org.apache.poi:poi:5.2.5"
implementation "org.apache.poi:poi-ooxml:5.2.5"
```

------

## Kotlin å¯¼å‡ºç¤ºä¾‹

```
fun exportExcel(
    context: Context,
    worker: Worker,
    records: List<Attendance>,
    salary: SalaryResult
) {

    val workbook = XSSFWorkbook()

    val sheet = workbook.createSheet("è€ƒå‹¤è®°å½•")

    val header = sheet.createRow(0)
    header.createCell(0).setCellValue("æ—¥æœŸ")
    header.createCell(1).setCellValue("ä¸Šåˆ")
    header.createCell(2).setCellValue("ä¸‹åˆ")
    header.createCell(3).setCellValue("åŠ ç­")
    header.createCell(4).setCellValue("å¤‡æ³¨")

    records.forEachIndexed { index, r ->
        val row = sheet.createRow(index + 1)
        row.createCell(0).setCellValue(r.date)
        row.createCell(1).setCellValue(if (r.morning) "âˆš" else "")
        row.createCell(2).setCellValue(if (r.afternoon) "âˆš" else "")
        row.createCell(3).setCellValue(r.overtimeHours)
        row.createCell(4).setCellValue(r.remark)
    }

    val salarySheet = workbook.createSheet("å·¥èµ„ç»Ÿè®¡")

    salarySheet.createRow(0).createCell(0).setCellValue("å§“å")
    salarySheet.getRow(0).createCell(1).setCellValue("æ€»å·¥èµ„")

    salarySheet.createRow(1).createCell(0).setCellValue(worker.name)
    salarySheet.getRow(1).createCell(1).setCellValue(salary.totalSalary)

    val file = File(
        context.getExternalFilesDir(null),
        "è€ƒå‹¤_${worker.name}.xlsx"
    )

    val fos = FileOutputStream(file)
    workbook.write(fos)
    fos.close()
    workbook.close()
}
```

------

# ä¸ƒã€UIç•Œé¢ç»“æ„å›¾

```
é¦–é¡µ
 â”œâ”€â”€ å·¥äººåˆ—è¡¨
 â”œâ”€â”€ æ·»åŠ å·¥äººæŒ‰é’®
 â”œâ”€â”€ ç‚¹å‡»è¿›å…¥å·¥äººè¯¦æƒ…

å·¥äººè¯¦æƒ…é¡µ
 â”œâ”€â”€ æœ¬æœˆå·¥èµ„å¡ç‰‡
 â”œâ”€â”€ æ—¥å†è§†å›¾
 â”œâ”€â”€ æœ¬æœˆç»Ÿè®¡
 â”œâ”€â”€ å¯¼å‡ºExcelæŒ‰é’®

å½•å…¥é¡µ
 â”œâ”€â”€ æ—¥æœŸé€‰æ‹©
 â”œâ”€â”€ ä¸Šåˆ âˆš
 â”œâ”€â”€ ä¸‹åˆ âˆš
 â”œâ”€â”€ åŠ ç­è¾“å…¥æ¡†
 â”œâ”€â”€ ä¿å­˜æŒ‰é’®

ç»Ÿè®¡é¡µ
 â”œâ”€â”€ æœˆç»Ÿè®¡
 â”œâ”€â”€ å¹´ç»Ÿè®¡
 â”œâ”€â”€ å·¥èµ„æ’è¡Œ
```

------

# å…«ã€æ ¸å¿ƒåŠŸèƒ½æµç¨‹

## æ–°å»ºå·¥äºº

ç”¨æˆ·è¾“å…¥ï¼š

- å§“å
- æ—¥å·¥èµ„
- åŠ ç­æ—¶è–ª

ä¿å­˜åˆ° workers è¡¨ã€‚

------

## å½•å…¥è€ƒå‹¤

é€‰æ‹©ï¼š

- å·¥äºº
- æ—¥æœŸ
- ä¸Šåˆ/ä¸‹åˆ
- åŠ ç­å°æ—¶

ä¿å­˜åˆ° attendance è¡¨ã€‚

------

## ç»Ÿè®¡å·¥èµ„

1. æŸ¥è¯¢æŸæœˆè®°å½•
2. è°ƒç”¨ calculateSalary()
3. æ˜¾ç¤ºå·¥èµ„

------

## å¯¼å‡ºExcel

1. æŸ¥è¯¢è®°å½•
2. è®¡ç®—å·¥èµ„
3. å†™å…¥ Excel
4. ä¿å­˜æœ¬åœ°

------

# ä¹ã€åç»­å¯æ‰©å±•åŠŸèƒ½

- äº‘å¤‡ä»½
- å¤šè®¾å¤‡åŒæ­¥
- è‡ªåŠ¨ç®—å·¥èµ„æ¡
- æ‰“å°åŠŸèƒ½
- æ‰«ç æ‰“å¡

------

# åã€AI å¼€å‘æç¤ºè¯ï¼ˆç›´æ¥å–‚ AIï¼‰

ä½ å¯ä»¥ç›´æ¥æŠŠè¿™æ®µå‘ç»™ AIï¼š

```
è¯·æ ¹æ®ä»¥ä¸‹éœ€æ±‚ç”Ÿæˆ Android Kotlin é¡¹ç›®ä»£ç ï¼š

- ä½¿ç”¨ Jetpack Compose
- ä½¿ç”¨ Room æ•°æ®åº“
- å®ç°å·¥äººç®¡ç†ã€è€ƒå‹¤è®°å½•ã€å·¥èµ„è®¡ç®—
- å®ç° Excel å¯¼å‡ºåŠŸèƒ½
- æŒ‰æ–‡æ¡£æ•°æ®åº“ç»“æ„å®ç°
- æŒ‰æ–‡æ¡£å·¥èµ„é€»è¾‘å®ç°

ç”Ÿæˆå®Œæ•´é¡¹ç›®ç»“æ„ä¸ç¤ºä¾‹ä»£ç ã€‚
```